
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>CI Setup &#8212; Roberto 1.3.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="How to contribute?" href="contributing.html" />
    <link rel="prev" title="Configuration" href="configuration.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="ci-setup">
<span id="setupci"></span><h1>CI Setup<a class="headerlink" href="#ci-setup" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general-instructions">
<h2>General instructions<a class="headerlink" href="#general-instructions" title="Permalink to this headline">¶</a></h2>
<p>When using Roberto to drive a continuous integration (CI) setup, you may want to
set additional environment variables:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ROBERTO_CONDA_PINNING</span></code> can be used to pin any dependencies to a specific
version, e.g. <code class="docutils literal notranslate"><span class="pre">&quot;python</span> <span class="pre">3.5&quot;</span></code> will let Roberto install Python-3.5 instead of
the default. This variable must be an even number of strings separated by
spaces, each time a conda package followed by a version number.</li>
<li><code class="docutils literal notranslate"><span class="pre">ROBERTO_DEPLOY_BINARY</span></code>. Set this to <code class="docutils literal notranslate"><span class="pre">1</span></code> if you want Roberto to upload
binary releases.</li>
<li><code class="docutils literal notranslate"><span class="pre">ROBERTO_DEPLOY_NOARCH</span></code>. Set this to <code class="docutils literal notranslate"><span class="pre">1</span></code> if you want Roberto to upload
architecture independent releases</li>
<li><code class="docutils literal notranslate"><span class="pre">ROBERTO_UPLOAD_COVERAGE</span></code>. Set this to <code class="docutils literal notranslate"><span class="pre">1</span></code> if you want coverage reports
on CodeCov.</li>
<li><code class="docutils literal notranslate"><span class="pre">GITHUB_TOKEN</span></code>: a token with write access to your repo, to
make deployment to Github and pushing to gh-pages work.</li>
<li><code class="docutils literal notranslate"><span class="pre">ANACONDA_API_TOKEN</span></code>: a token to make anaconda uploads work.</li>
<li><code class="docutils literal notranslate"><span class="pre">TWINE_USERNAME</span></code> and <code class="docutils literal notranslate"><span class="pre">TWINE_PASSWORD</span></code>: needed for uploads to pypi.</li>
</ul>
<p>Make sure tokens are encrypted and passwords in your CI configuration
file.</p>
<p>Besides setting the above environment variables, you also need to install and
run Roberto correctly. The following minimalistic set of bash commands should
work on both Linux and OSX:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># These commands assume you are in the root of the repository and</span>
<span class="c1"># that a basic Python 3 (&gt;= 3.5) is installed.</span>
<span class="c1"># 1) Install pip and roberto</span>
wget --no-clobber -O <span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/get-pip.py https://bootstrap.pypa.io/get-pip.py <span class="o">||</span> <span class="nb">true</span>
python3 <span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/get-pip.py --user
python3 -m pip install roberto --user
<span class="c1"># 2) Run Roberto</span>
python3 -m roberto
</pre></div>
</div>
</div>
<div class="section" id="tips-and-tricks-for-travis-ci">
<h2>Tips and tricks for Travis-CI<a class="headerlink" href="#tips-and-tricks-for-travis-ci" title="Permalink to this headline">¶</a></h2>
<p>Travis is extensively documented and this section does not replace that
documentation. See <a class="reference external" href="https://docs.travis-ci.com/">https://docs.travis-ci.com/</a></p>
<div class="section" id="minimal-example-of-a-travis-yaml-file-that-uses-roberto">
<h3>Minimal example of a <code class="docutils literal notranslate"><span class="pre">.travis.yaml</span></code> file that uses Roberto<a class="headerlink" href="#minimal-example-of-a-travis-yaml-file-that-uses-roberto" title="Permalink to this headline">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">matrix</span><span class="p">:</span>
  <span class="nt">include</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">os</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">linux</span>
      <span class="nt">dist</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xenial</span>
      <span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generic</span>
      <span class="nt">env</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROBERTO_CONDA_PINNING=&quot;python 3.6&quot;</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROBERTO_DEPLOY_BINARY=1</span>
    <span class="p p-Indicator">-</span> <span class="nt">os</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">linux</span>
      <span class="nt">dist</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xenial</span>
      <span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generic</span>
      <span class="nt">env</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROBERTO_CONDA_PINNING=&quot;python 3.7&quot;</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROBERTO_DEPLOY_NOARCH=1</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROBERTO_DEPLOY_BINARY=1</span>
    <span class="p p-Indicator">-</span> <span class="nt">os</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">osx</span>
      <span class="nt">osx_image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xcode9.4</span>
      <span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generic</span>
      <span class="nt">env</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROBERTO_CONDA_PINNING=&quot;python 3.6&quot;</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROBERTO_DEPLOY_BINARY=1</span>
    <span class="p p-Indicator">-</span> <span class="nt">os</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">osx</span>
      <span class="nt">osx_image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xcode9.4</span>
      <span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generic</span>
      <span class="nt">env</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROBERTO_CONDA_PINNING=&quot;python 3.7&quot;</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROBERTO_DEPLOY_BINARY=1</span>

<span class="nt">env</span><span class="p">:</span>
  <span class="nt">global</span><span class="p">:</span>
    <span class="c1"># Install conda in a *sub*directory of a</span>
    <span class="c1"># directory cached by travis.</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROBERTO_CONDA_BASE_PATH=${HOME}/cache/miniconda3</span>
    <span class="c1"># Tell Roberto to upload coverage results</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROBERTO_UPLOAD_COVERAGE=1</span>
    <span class="c1"># Build conda packages outside the</span>
    <span class="c1"># miniconda tree, to avoid caching.</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CONDA_BLD_PATH=${HOME}/conda-bld</span>
    <span class="c1"># Tell roberto which branch is being</span>
    <span class="c1"># merged into, in case of a PR.</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROBERTO_MERGE_BRANCH=${TRAVIS_BRANCH}</span>

    <span class="c1"># GITHUB_TOKEN</span>
    <span class="c1"># yamllint disable-line rule:line-length</span>
    <span class="c1"># - secure: &quot;...&quot;</span>
    <span class="c1"># ANACONDA_API_TOKEN</span>
    <span class="c1"># yamllint disable-line rule:line-length</span>
    <span class="c1"># - secure: &quot;...&quot;</span>
    <span class="c1"># TWINE_PASSWORD</span>
    <span class="c1"># yamllint disable-line rule:line-length</span>
    <span class="c1"># - secure: &quot;...&quot;</span>
    <span class="c1"># - TWINE_USERNAME: theochem</span>

<span class="nt">cache</span><span class="p">:</span>
  <span class="c1"># More time is needed for caching due to</span>
  <span class="c1"># the sheer size of the conda env.</span>
  <span class="nt">timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
  <span class="nt">directories</span><span class="p">:</span>
    <span class="c1"># Everything under the cache directory will be archived and made</span>
    <span class="c1"># available in subsequent builds to speed them up.</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">${HOME}/cache</span>

<span class="nt">install</span><span class="p">:</span>
  <span class="c1"># Disable deployment when TRAVIS_TAG is not set.</span>
  <span class="c1"># This avoids duplicate deployments.</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">if [[ -z $TRAVIS_TAG ]]; then</span>
      <span class="l l-Scalar l-Scalar-Plain">export ROBERTO_DEPLOY_BINARY=0 ROBERTO_DEPLOY_NOARCH=0;</span>
    <span class="l l-Scalar l-Scalar-Plain">fi</span>
  <span class="c1"># Get a basic python 3 with pip to run roberto</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">python3 --version</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">wget --no-clobber -O ${HOME}/cache/get-pip.py</span>
    <span class="l l-Scalar l-Scalar-Plain">https://bootstrap.pypa.io/get-pip.py || true</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">python3 ${HOME}/cache/get-pip.py --user</span>
  <span class="c1"># To avoid surprises, constrain the major</span>
  <span class="c1"># version number of roberto.</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">python3 -m pip install &#39;roberto&lt;2.0.0&#39; --user</span>

<span class="nt">script</span><span class="p">:</span>
  <span class="c1"># Instead of simply calling `rob`, do something that</span>
  <span class="c1"># always works on OSX too. When testing a pull request,</span>
  <span class="c1"># it is sufficient to run only the quality checks on</span>
  <span class="c1"># the in-place build, which should catch 99% of the</span>
  <span class="c1"># problems while it is considerably faster.</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">if [[ &quot;$TRAVIS_PULL_REQUEST&quot; == &quot;false&quot; ]]; then</span>
      <span class="l l-Scalar l-Scalar-Plain">python3 -m roberto robot;</span>
    <span class="l l-Scalar l-Scalar-Plain">else</span>
      <span class="l l-Scalar l-Scalar-Plain">python3 -m roberto;</span>
    <span class="l l-Scalar l-Scalar-Plain">fi</span>

<span class="nt">before_cache</span><span class="p">:</span>
  <span class="c1"># Remove things that are not needed in subsequent builds.</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rm -rf ${ROBERTO_CONDA_BASE_PATH}/conda-bld</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rm -rf ${ROBERTO_CONDA_BASE_PATH}/locks</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rm -rf ${ROBERTO_CONDA_BASE_PATH}/pkgs</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rm -rf ${ROBERTO_CONDA_BASE_PATH}/var</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rm -rf ${ROBERTO_CONDA_BASE_PATH}/envs/*/conda-bld</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rm -rf ${ROBERTO_CONDA_BASE_PATH}/envs/*/locks</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rm -rf ${ROBERTO_CONDA_BASE_PATH}/envs/*/pkgs</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rm -rf ${ROBERTO_CONDA_BASE_PATH}/envs/*/var</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-up-encrypted-tokens-and-passwords-for-theochem-admins">
<h3>Setting up encrypted tokens and passwords (for theochem admins)<a class="headerlink" href="#setting-up-encrypted-tokens-and-passwords-for-theochem-admins" title="Permalink to this headline">¶</a></h3>
<p><strong>GITHUB_TOKEN</strong></p>
<ol class="arabic" start="0">
<li><p class="first">Install the <code class="docutils literal notranslate"><span class="pre">travis-ci</span></code> command-line client. See
<a class="reference external" href="https://github.com/travis-ci/travis.rb#installation">https://github.com/travis-ci/travis.rb#installation</a></p>
</li>
<li><p class="first">Login with the theochem-ci-bot account on github.com.</p>
</li>
<li><p class="first">Go to profile settings: <a class="reference external" href="https://github.com/settings/profile">https://github.com/settings/profile</a></p>
</li>
<li><p class="first">Select “Developer settings”.</p>
</li>
<li><p class="first">Select “Personal access tokens”.</p>
</li>
<li><p class="first">Create a new token “automatic releases for theochem/???” and
activate “public_repo”, then save.</p>
</li>
<li><p class="first">Copy the token. It is only shown once.</p>
</li>
<li><p class="first">Encrypt the token on the command line</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>travis encrypt --pro <span class="nv">GITHUB_TOKEN</span><span class="o">=</span><span class="s2">&quot;[copy-paste-your-github-token]&quot;</span>
</pre></div>
</div>
<p>This command asks for a username and a password of the theochem-ci-bot
account. (Do not use the <code class="docutils literal notranslate"><span class="pre">--add</span></code> feature.)</p>
</li>
<li><p class="first">Put the output in <code class="docutils literal notranslate"><span class="pre">.travis.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">env</span><span class="p">:</span>
  <span class="nt">global</span><span class="p">:</span>
    <span class="c1"># ...</span>
    <span class="c1"># GITHUB_TOKEN</span>
    <span class="c1"># yamllint disable-line rule:line-length</span>
    <span class="p p-Indicator">-</span> <span class="nt">secure</span><span class="p">:</span> <span class="s">&quot;...&quot;</span>
</pre></div>
</div>
<p>Do not forget to add a comment so everyone can figure out the purpose of the
encrypted string.</p>
</li>
<li><p class="first">Add the repository to the list the Buildtools team on theochem and
enable write permission.</p>
</li>
</ol>
<p><strong>ANACONDA_API_TOKEN</strong></p>
<ol class="arabic" start="0">
<li><p class="first">Install the <code class="docutils literal notranslate"><span class="pre">travis-ci</span></code> command-line client. See
<a class="reference external" href="https://github.com/travis-ci/travis.rb#installation">https://github.com/travis-ci/travis.rb#installation</a></p>
</li>
<li><p class="first">Login on anaconda.org (with our bot account).</p>
</li>
<li><p class="first">Go to profile settings: <a class="reference external" href="https://anaconda.org/theochem/settings/profile">https://anaconda.org/theochem/settings/profile</a></p>
</li>
<li><p class="first">Select “Access”.</p>
</li>
<li><p class="first">Create a new token (Allow all API operations)</p>
</li>
<li><p class="first">Copy the token.</p>
</li>
<li><p class="first">Encrypt the token on the command line</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>travis encrypt --pro <span class="nv">ANACONDA_API_TOKEN</span><span class="o">=</span><span class="s2">&quot;[copy-paste-your-anaconda-token]&quot;</span>
</pre></div>
</div>
<p>This command asks for a username and a password of the theochem-ci-bot
account. (Do not use the <code class="docutils literal notranslate"><span class="pre">--add</span></code> feature.)</p>
</li>
<li><p class="first">Put the output in <code class="docutils literal notranslate"><span class="pre">.travis.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">env</span><span class="p">:</span>
  <span class="nt">global</span><span class="p">:</span>
    <span class="c1"># ...</span>
    <span class="c1"># ANACONDA_API_TOKEN</span>
    <span class="c1"># yamllint disable-line rule:line-length</span>
    <span class="p p-Indicator">-</span> <span class="nt">secure</span><span class="p">:</span> <span class="s">&quot;...&quot;</span>
</pre></div>
</div>
<p>Do not forget to add a comment so everyone can figure out the purpose of the
encrypted string.</p>
</li>
</ol>
<p><strong>TWINE_PASSWORD</strong></p>
<ol class="arabic" start="0">
<li><p class="first">Install the <code class="docutils literal notranslate"><span class="pre">travis-ci</span></code> command-line client. See
<a class="reference external" href="https://github.com/travis-ci/travis.rb#installation">https://github.com/travis-ci/travis.rb#installation</a></p>
</li>
<li><p class="first">Encrypt the Pypi password on the command line</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>travis encrypt --pro <span class="nv">TWINE_PASSWORD</span><span class="o">=</span><span class="s1">&#39;[copy-paste-pypi-password]&#39;</span>
</pre></div>
</div>
<p>This command asks for a username and a password of the theochem-ci-bot
account. (Do not use the <code class="docutils literal notranslate"><span class="pre">--add</span></code> feature.)</p>
</li>
<li><p class="first">Put the output and the username in <code class="docutils literal notranslate"><span class="pre">.travis.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">env</span><span class="p">:</span>
  <span class="nt">global</span><span class="p">:</span>
    <span class="c1"># ...</span>
    <span class="c1"># TWINE_PASSWORD</span>
    <span class="c1"># yamllint disable-line rule:line-length</span>
    <span class="p p-Indicator">-</span> <span class="nt">secure</span><span class="p">:</span> <span class="s">&quot;...&quot;</span>
    <span class="p p-Indicator">-</span> <span class="nt">TWINE_USERNAME</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">theochem</span>
</pre></div>
</div>
<p>Do not forget to add a comment so everyone can figure out the purpose of the
encrypted string.</p>
</li>
</ol>
</div>
<div class="section" id="troubleshooting-encrypted-token-issues">
<h3>Troubleshooting encrypted token issues<a class="headerlink" href="#troubleshooting-encrypted-token-issues" title="Permalink to this headline">¶</a></h3>
<p>Debugging issues with encrypted tokens and passwords can be very tricky.
Here are some clues to overcome the most common problems:</p>
<ul class="simple">
<li>When the en- or decryption has somehow failed, the corresponding variables
are not set when your build runs on Travis-CI. You should be able to see this
in the header of the build log (under the section <code class="docutils literal notranslate"><span class="pre">Setting</span> <span class="pre">environment</span>
<span class="pre">variables</span> <span class="pre">from</span> <span class="pre">.travis.yml</span></code>). It normally shows all variables, with the
encrypted ones masked as <code class="docutils literal notranslate"><span class="pre">MEANINGFULL_NAME=[secure]</span></code>. When it fails, you
see something like <code class="docutils literal notranslate"><span class="pre">wPKmdvIo2cOt6SH02fDd=[secure]</span></code>.</li>
<li>The deployment scripts will fail if the necessary tokens or passwords are
not found in the right environment variables. Twine and hub will start
asking for login crediatials. Anaconda will fail without clear error
message. Roberto checks the required variables and will print for each one if
it is not set, empty or not empty.</li>
<li>The order of the lines in the build log tends to get mixed up near the
deployment scripts, so it may not be easy to follow what is going on.</li>
<li>The simplest solution to try first, is a second attempt to encrypt the
variables. If that does not work, check if something else is causing the
problem by running the Travis-CI image in a docker instance as explained
below. In this docker instance, just use non-encrypted variables.</li>
<li>We had some issues with encryption before on travis-ci.org that magically
disappaered on travis-ci.com. The <code class="docutils literal notranslate"><span class="pre">--pro</span></code> argument mentioned in the
instructions above is needed for travis-ci.com, not for travis-ci.org.</li>
</ul>
</div>
<div class="section" id="manually-running-tests-in-a-travis-docker-image">
<h3>Manually running tests in a Travis docker image<a class="headerlink" href="#manually-running-tests-in-a-travis-docker-image" title="Permalink to this headline">¶</a></h3>
<p>Even when <code class="docutils literal notranslate"><span class="pre">rob</span></code> reports no problems your local computer, <code class="docutils literal notranslate"><span class="pre">rob</span></code> might still
print errors for exactly the same code on Travis. (This should be rare though.)
In this case, it could be helpful to run <code class="docutils literal notranslate"><span class="pre">rob</span></code> or any other tests manually in
a Travis docker image:</p>
<ol class="arabic">
<li><p class="first">Install docker-ce: <a class="reference external" href="https://docs.docker.com/install/">https://docs.docker.com/install/</a></p>
</li>
<li><p class="first">Get an up-to-date travis-ci docker image. For our linux builds, these can
be found here: <a class="reference external" href="https://hub.docker.com/r/travisci/ci-sardonyx/tags">https://hub.docker.com/r/travisci/ci-sardonyx/tags</a></p>
<p>Download as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker pull travisci/ci-sardonyx:packer-1549881206-387f377
</pre></div>
</div>
<p>This will take a while. (3GB download!)
You may want to use a newer tag than <code class="docutils literal notranslate"><span class="pre">packer-1549881206-387f377</span></code>.</p>
</li>
<li><p class="first">Run the headless image:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker run --name foobar <span class="se">\</span>
    travisci/ci-sardonyx:packer-1549881206-387f377 <span class="se">\</span>
    /sbin/init
</pre></div>
</div>
<p>where you may also need to change the tag to be consistent with step 2.
Note that tab completion can be convenient.</p>
</li>
<li><p class="first">In another terminal window, run the following, to get into the docker
instance:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker <span class="nb">exec</span> -it foobar bash -l
</pre></div>
</div>
</li>
<li><p class="first">Once in the image, switch first to the travis user:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>su - travis
</pre></div>
</div>
</li>
<li><p class="first">Then run all the commands you encounter in the travis log and debug.</p>
</li>
<li><p class="first">When done, log out of the instance (exit two times)</p>
</li>
<li><p class="first">Stop the instance</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker stop foobar
</pre></div>
</div>
</li>
<li><p class="first">Clean up</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker rm foobar
</pre></div>
</div>
<p>This will clean up your experiments, but not the image you downloaded.</p>
</li>
</ol>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Roberto</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Read me first</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Work flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CI Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-instructions">General instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tips-and-tricks-for-travis-ci">Tips and tricks for Travis-CI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">How to contribute?</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change log</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="configuration.html" title="previous chapter">Configuration</a></li>
      <li>Next: <a href="contributing.html" title="next chapter">How to contribute?</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, The Roberto Development Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/setupci.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>